<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="金声玉振">
<meta property="og:type" content="website">
<meta property="og:title" content="金声玉振">
<meta property="og:url" content="http://jinweida.github.io/index.html">
<meta property="og:site_name" content="金声玉振">
<meta property="og:description" content="金声玉振">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="金声玉振">
<meta name="twitter:description" content="金声玉振">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://jinweida.github.io/"/>





  <title>金声玉振</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">金声玉振</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-04-02/Kubernetesb系列-apiserver.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-04-02/Kubernetesb系列-apiserver.html" itemprop="url">Kubernetesb系列-apiserver</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-02T23:40:08+07:00">
                2018-04-02
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-05T14:45:14+07:00">
                2018-04-05
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/kubernetes/" itemprop="url" rel="index">
                    <span itemprop="name">kubernetes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-04-02/Kubernetesb系列-apiserver.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-04-02/Kubernetesb系列-apiserver.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="api-server简介"><a href="#api-server简介" class="headerlink" title="api server简介"></a>api server简介</h3><p>k8s API Server提供了k8s各类资源对象（pod,RC,Service等）的增删改查及watch等HTTP Rest接口，是整个系统的数据总线和数据中心。</p>
<ul>
<li>提供了集群管理的REST API接口(包括认证授权、数据校验以及集群状态变更)；</li>
<li>提供其他模块之间的数据交互和通信的枢纽（其他模块通过API Server查询或修改数据，只有API Server才直接操作etcd）;</li>
<li>是资源配额控制的入口；</li>
<li>拥有完备的集群安全机制.</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018-04-02/Kubernetesb系列-apiserver.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-04-02/Kubernetesb系列-集群问题排查.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-04-02/Kubernetesb系列-集群问题排查.html" itemprop="url">Kubernetesb系列-集群问题排查</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-02T21:19:16+07:00">
                2018-04-02
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-05T14:35:21+07:00">
                2018-04-05
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/kubernetes/" itemprop="url" rel="index">
                    <span itemprop="name">kubernetes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-04-02/Kubernetesb系列-集群问题排查.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-04-02/Kubernetesb系列-集群问题排查.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Kubectl上下文和配置"><a href="#Kubectl上下文和配置" class="headerlink" title="Kubectl上下文和配置"></a>Kubectl上下文和配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> kubectl config view # 显示合并的 kubeconfig 设置。</span><br><span class="line"><span class="meta">#</span> 同时使用多个 kubeconfig 文件，并且查看合并的配置</span><br><span class="line"><span class="meta">$</span> KUBECONFIG=~/.kube/config:~/.kube/kubconfig2 kubectl config view</span><br><span class="line"><span class="meta">#</span> 查看名称为 “e2e” 的用户的密码</span><br><span class="line"><span class="meta">$</span> kubectl config view -o jsonpath='&#123;.users[?(@.name == "e2e")].user.password&#125;'</span><br><span class="line"><span class="meta">$</span> kubectl config current-context              # 显示当前上下文</span><br><span class="line"><span class="meta">$</span> kubectl config use-context my-cluster-name  # 设置默认的上下文为 my-cluster-name</span><br><span class="line"><span class="meta">#</span> 在 kubeconf 中添加一个支持基本鉴权的新集群。</span><br><span class="line"><span class="meta">$</span> kubectl config set-credentials kubeuser/foo.kubernetes.com --username=kubeuser --password=kubepassword</span><br><span class="line"><span class="meta">#</span> 使用特定的用户名和命名空间设置上下文。</span><br><span class="line"><span class="meta">$</span> kubectl config set-context gce --user=cluster-admin --namespace=foo \</span><br><span class="line">  &amp;&amp; kubectl config use-context gce</span><br></pre></td></tr></table></figure>
<h3 id="查看、查找资源"><a href="#查看、查找资源" class="headerlink" title="查看、查找资源"></a>查看、查找资源</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 查看集群</span><br><span class="line"><span class="meta">$</span> kubectl cluster-info</span><br><span class="line"><span class="meta">#</span> 分页查看更具体的信息</span><br><span class="line"><span class="meta">$</span> kubectl cluster-info dump | more</span><br><span class="line"><span class="meta">#</span> 查看pods所在的运行节点</span><br><span class="line"><span class="meta">$</span> kubectl get pods -o wide --all-namespaces</span><br><span class="line"><span class="meta">#</span> 按selector名来查找pod</span><br><span class="line"><span class="meta">$</span> kubectl get pod --selector name=redis</span><br><span class="line"><span class="meta">#</span> 具有基本输出的 get 命令</span><br><span class="line"><span class="meta">$</span> kubectl get services                          # 列出命名空间下的所有 service</span><br><span class="line"><span class="meta">$</span> kubectl get pods --all-namespaces             # 列出所有命名空间下的 pod</span><br><span class="line"><span class="meta">$</span> kubectl get pods -o wide                      # 列出命名空间下所有 pod，带有更详细的信息</span><br><span class="line"><span class="meta">$</span> kubectl get deployment my-dep                 # 列出特定的 deployment</span><br><span class="line"><span class="meta">$</span> kubectl get pods --include-uninitialized      # 列出命名空间下所有的 pod，包括未初始化的对象</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 有详细输出的 describe 命令</span><br><span class="line"><span class="meta">$</span> kubectl describe nodes my-node</span><br><span class="line"><span class="meta">$</span> kubectl describe pods my-pod</span><br><span class="line"><span class="meta">$</span> kubectl get services --sort-by=.metadata.name # List Services Sorted by Name</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 根据重启次数排序，列出所有 pod</span><br><span class="line"><span class="meta">$</span> kubectl get pods --sort-by='.status.containerStatuses[0].restartCount'</span><br><span class="line"><span class="meta">#</span> 查询带有标签 app=cassandra 的所有 pod，获取它们的 version 标签值</span><br><span class="line"><span class="meta">$</span> kubectl get pods --selector=app=cassandra rc -o \</span><br><span class="line">  jsonpath='&#123;.items[*].metadata.labels.version&#125;'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 获取命名空间下所有运行中的 pod</span><br><span class="line"><span class="meta">$</span> kubectl get pods --field-selector=status.phase=Running</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 所有所有节点的 ExternalIP</span><br><span class="line"><span class="meta">$</span> kubectl get nodes -o jsonpath='&#123;.items[*].status.addresses[?(@.type=="ExternalIP")].address&#125;'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 列出输出特定 RC 的所有 pod 的名称</span><br><span class="line"><span class="meta">#</span> "jq" 命令对那些 jsonpath 看来太复杂的转换非常有用，可以在这找到：https://stedolan.github.io/jq/</span><br><span class="line"><span class="meta">$</span> sel=$&#123;$(kubectl get rc my-rc --output=json | jq -j '.spec.selector | to_entries | .[] | "\(.key)=\(.value),"')%?&#125;</span><br><span class="line"><span class="meta">$</span> echo $(kubectl get pods --selector=$sel --output=jsonpath=&#123;.items..metadata.name&#125;)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 检查那些节点已经 ready</span><br><span class="line"><span class="meta">$</span> JSONPATH='&#123;range .items[*]&#125;&#123;@.metadata.name&#125;:&#123;range @.status.conditions[*]&#125;&#123;@.type&#125;=&#123;@.status&#125;;&#123;end&#125;&#123;end&#125;' \</span><br><span class="line"> &amp;&amp; kubectl get nodes -o jsonpath="$JSONPATH" | grep "Ready=True"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 列出某个 pod 目前在用的所有 Secret</span><br><span class="line"><span class="meta">$</span> kubectl get pods -o json | jq '.items[].spec.containers[].env[]?.valueFrom.secretKeyRef.name' | grep -v null | sort | uniq</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 列出通过 timestamp 排序的所有 Event</span><br><span class="line"><span class="meta">$</span> kubectl get events --sort-by=.metadata.creationTimestamp</span><br></pre></td></tr></table></figure>
<h3 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> kubectl create -f ./my-manifest.yaml           # 创建资源</span><br><span class="line"><span class="meta">$</span> kubectl create -f ./my1.yaml -f ./my2.yaml     # 从多个文件创建资源</span><br><span class="line"><span class="meta">$</span> kubectl create -f ./dir                        # 通过目录下的所有清单文件创建资源</span><br><span class="line"><span class="meta">$</span> kubectl create -f https://git.io/vPieo         # 使用 url 获取清单创建资源</span><br><span class="line"><span class="meta">$</span> kubectl run nginx --image=nginx                # 开启一个 nginx 实例</span><br><span class="line"><span class="meta">$</span> kubectl explain pods,svc                       # 获取 pod 和服务清单的描述文档</span><br></pre></td></tr></table></figure>
<h3 id="更新资源"><a href="#更新资源" class="headerlink" title="更新资源"></a>更新资源</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 滚动更新 pod：frontend-v1</span><br><span class="line"><span class="meta">$</span> kubectl rolling-update frontend-v1 -f frontend-v2.json </span><br><span class="line"><span class="meta">#</span> 变更资源的名称并更新镜像          </span><br><span class="line"><span class="meta">$</span> kubectl rolling-update frontend-v1 frontend-v2 --image=image:v2 </span><br><span class="line"><span class="meta">#</span> 更新 pod 的镜像 </span><br><span class="line"><span class="meta">$</span> kubectl rolling-update frontend --image=image:v2 </span><br><span class="line"><span class="meta">#</span> 中止进行中的过程                </span><br><span class="line"><span class="meta">$</span> kubectl rolling-update frontend-v1 frontend-v2 --rollback</span><br><span class="line"><span class="meta">#</span> 根据传入标准输入的 JSON 替换一个 pod        </span><br><span class="line"><span class="meta">$</span> cat pod.json | kubectl replace -f -                             </span><br><span class="line"><span class="meta">#</span> 强制替换，先删除，然后再重建资源。会导致服务中断。</span><br><span class="line"><span class="meta">$</span> kubectl replace --force -f ./pod.json</span><br><span class="line"><span class="meta">#</span> 为副本控制器（rc）创建服务，它开放 80 端口，并连接到容器的 8080 端口</span><br><span class="line"><span class="meta">$</span> kubectl expose rc nginx --port=80 --target-port=8000</span><br><span class="line"><span class="meta">#</span> 更新单容器的 pod，将其镜像版本（tag）更新到 v4</span><br><span class="line"><span class="meta">$</span> kubectl get pod mypod -o yaml | sed 's/\(image: myimage\):.*$/\1:v4/' | kubectl replace -f -</span><br><span class="line"><span class="meta">#</span> 增加标签</span><br><span class="line"><span class="meta">$</span> kubectl label pods my-pod new-label=awesome </span><br><span class="line"><span class="meta">#</span> 增加注释                     </span><br><span class="line"><span class="meta">$</span> kubectl annotate pods my-pod icon-url=http://goo.gl/XXBTWq</span><br><span class="line"><span class="meta">#</span> 将名称为 foo 的 deployment 设置为自动扩缩容       </span><br><span class="line"><span class="meta">$</span> kubectl autoscale deployment foo --min=2 --max=10</span><br></pre></td></tr></table></figure>
<h3 id="修补资源"><a href="#修补资源" class="headerlink" title="修补资源"></a>修补资源</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 部分更新节点</span><br><span class="line"><span class="meta">$</span> kubectl patch node k8s-node-1 -p '&#123;"spec":&#123;"unschedulable":true&#125;&#125;' </span><br><span class="line"><span class="meta">#</span> 更新容器的镜像，spec.containers[*].name 是必需的，因为它们是一个合并键</span><br><span class="line"><span class="meta">$</span> kubectl patch pod valid-pod -p '&#123;"spec":&#123;"containers":[&#123;"name":"kubernetes-serve-hostname","image":"new image"&#125;]&#125;&#125;'</span><br><span class="line"><span class="meta">#</span> 使用带有数组位置信息的 json 修补程序更新容器镜像</span><br><span class="line"><span class="meta">$</span> kubectl patch pod valid-pod --type='json' -p='[&#123;"op": "replace", "path": "/spec/containers/0/image", "value":"new image"&#125;]'</span><br><span class="line"><span class="meta">#</span> 使用带有数组位置信息的 json 修补程序禁用 deployment 的 livenessProbe</span><br><span class="line"><span class="meta">$</span> kubectl patch deployment valid-deployment  --type json   -p='[&#123;"op": "remove", "path": "/spec/template/spec/containers/0/livenessProbe"&#125;]'</span><br><span class="line"><span class="meta">#</span> 增加新的元素到数组指定的位置中</span><br><span class="line"><span class="meta">$</span> kubectl patch sa default --type='json' -p='[&#123;"op": "add", "path": "/secrets/1", "value": &#123;"name": "whatever" &#125; &#125;]'</span><br></pre></td></tr></table></figure>
<h3 id="缩放资源"><a href="#缩放资源" class="headerlink" title="缩放资源"></a>缩放资源</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 缩放名称为 'foo' 的 replicaset，调整其副本数为 3</span><br><span class="line"><span class="meta">$</span> kubectl scale --replicas=3 rs/foo                                 </span><br><span class="line"><span class="meta">#</span> 缩放在 "foo.yaml" 中指定的资源，调整其副本数为 3</span><br><span class="line"><span class="meta">$</span> kubectl scale --replicas=3 -f foo.yaml                            </span><br><span class="line"><span class="meta">#</span> 如果名称为 mysql 的 deployment 目前规模为 2，将其规模调整为 3</span><br><span class="line"><span class="meta">$</span> kubectl scale --current-replicas=2 --replicas=3 deployment/mysql</span><br><span class="line"><span class="meta">#</span> 缩放多个副本控制器</span><br><span class="line"><span class="meta">$</span> kubectl scale --replicas=5 rc/foo rc/bar rc/baz</span><br></pre></td></tr></table></figure>
<h3 id="删除资源"><a href="#删除资源" class="headerlink" title="删除资源"></a>删除资源</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 使用 pod.json 中指定的类型和名称删除 pod</span><br><span class="line"><span class="meta">$</span> kubectl delete -f ./pod.json </span><br><span class="line"><span class="meta">#</span> 删除名称为 "baz" 和 "foo" 的 pod 和 service</span><br><span class="line"><span class="meta">$</span> kubectl delete pod,service baz foo  </span><br><span class="line"><span class="meta">#</span> 删除带有标签 name=myLabel 的 pod 和 service                                      </span><br><span class="line"><span class="meta">$</span> kubectl delete pods,services -l name=myLabel  </span><br><span class="line"><span class="meta">#</span> 删除带有标签 name=myLabel 的 pod 和 service，包括未初始化的对象                            </span><br><span class="line"><span class="meta">$</span> kubectl delete pods,services -l name=myLabel --include-uninitialized </span><br><span class="line"><span class="meta">#</span> 删除命名空间 my-ns 下所有的 pod 和 service，包括未初始化的对象     </span><br><span class="line"><span class="meta">$</span> kubectl -n my-ns delete po,svc --all </span><br><span class="line"><span class="meta">$</span> kubectl -n "kube-system" delete deployment tiller-deploy</span><br><span class="line"><span class="meta">$</span> kubectl -n "kube-system" delete service tiller-deploy</span><br></pre></td></tr></table></figure>
<h3 id="与运行中的-pod-交互"><a href="#与运行中的-pod-交互" class="headerlink" title="与运行中的 pod 交互"></a>与运行中的 pod 交互</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 转储 pod 日志到标准输出</span><br><span class="line"><span class="meta">$</span> kubectl logs my-pod  </span><br><span class="line"><span class="meta">#</span> 有多个容器的情况下，转储 pod 中容器的日志到标准输出                               </span><br><span class="line"><span class="meta">$</span> kubectl logs my-pod -c my-container</span><br><span class="line"><span class="meta">#</span> pod 日志流向标准输出                 </span><br><span class="line"><span class="meta">$</span> kubectl logs -f my-pod    </span><br><span class="line"><span class="meta">#</span> 有多个容器的情况下，pod 中容器的日志流到标准输出                          </span><br><span class="line"><span class="meta">$</span> kubectl logs -f my-pod -c my-container</span><br><span class="line"><span class="meta">#</span> 使用交互的 shell 运行 pod              </span><br><span class="line"><span class="meta">$</span> kubectl run -i --tty busybox --image=busybox -- sh </span><br><span class="line"><span class="meta">#</span> 关联到运行中的容器 </span><br><span class="line"><span class="meta">$</span> kubectl attach my-pod -i  </span><br><span class="line"><span class="meta">#</span> 在本地监听 5000 端口，然后转到 my-pod 的 6000 端口                          </span><br><span class="line"><span class="meta">$</span> kubectl port-forward my-pod 5000:6000 </span><br><span class="line"><span class="meta">#</span> 1 个容器的情况下，在已经存在的 pod 中运行命令              </span><br><span class="line"><span class="meta">$</span> kubectl exec my-pod -- ls /     </span><br><span class="line"><span class="meta">#</span> 多个容器的情况下，在已经存在的 pod 中运行命令                    </span><br><span class="line"><span class="meta">$</span> kubectl exec my-pod -c my-container -- ls / </span><br><span class="line"><span class="meta">#</span> 显示 pod 及其容器的度量        </span><br><span class="line"><span class="meta">$</span> kubectl top pod POD_NAME --containers</span><br></pre></td></tr></table></figure>
<h3 id="与-node-和集群交互"><a href="#与-node-和集群交互" class="headerlink" title="与 node 和集群交互"></a>与 node 和集群交互</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 标记节点 my-node 为不可调度</span><br><span class="line"><span class="meta">$</span> kubectl cordon my-node  </span><br><span class="line"><span class="meta">#</span> 准备维护时，排除节点 my-node                                              </span><br><span class="line"><span class="meta">$</span> kubectl drain my-node </span><br><span class="line"><span class="meta">#</span> 标记节点 my-node 为可调度                                                </span><br><span class="line"><span class="meta">$</span> kubectl uncordon my-node  </span><br><span class="line"><span class="meta">#</span> 显示给定节点的度量值                                            </span><br><span class="line"><span class="meta">$</span> kubectl top node my-node </span><br><span class="line"><span class="meta">#</span> 显示 master 和 service 的地址                                             </span><br><span class="line"><span class="meta">$</span> kubectl cluster-info  </span><br><span class="line"><span class="meta">#</span> 将集群的当前状态转储到标准输出                                                </span><br><span class="line"><span class="meta">$</span> kubectl cluster-info dump        </span><br><span class="line"><span class="meta">#</span> 将集群的当前状态转储到目录 /path/to/cluster-state </span><br><span class="line"><span class="meta">$</span> kubectl cluster-info dump --output-directory=/path/to/cluster-state</span><br><span class="line"><span class="meta">#</span> 如果带有该键和效果的污点已经存在，则将按指定的方式替换其值</span><br><span class="line"><span class="meta">$</span> kubectl taint nodes foo dedicated=special-user:NoSchedule</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-04-02/Kubernetesb系列-状态ContainerCreating.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-04-02/Kubernetesb系列-状态ContainerCreating.html" itemprop="url">Kubernetesb系列-状态ContainerCreating</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-02T21:19:16+07:00">
                2018-04-02
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-05T14:33:17+07:00">
                2018-04-05
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/kubernetes/" itemprop="url" rel="index">
                    <span itemprop="name">kubernetes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-04-02/Kubernetesb系列-状态ContainerCreating.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-04-02/Kubernetesb系列-状态ContainerCreating.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>集群环境环境使用kubeadm v1.10.0 搭建。</p>
<p>创建nginx集群实例<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@k8s-testnet-master-ohio:~# kubectl run my-nginx --image=nginx --replicas=2 --port=80</span><br></pre></td></tr></table></figure></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018-04-02/Kubernetesb系列-状态ContainerCreating.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-03-23/Kubernetesb系列-理解对象.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-03-23/Kubernetesb系列-理解对象.html" itemprop="url">Kubernetesb系列-理解对象</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-23T14:19:12+07:00">
                2018-03-23
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-03-31T09:23:36+07:00">
                2018-03-31
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/kubernetes/" itemprop="url" rel="index">
                    <span itemprop="name">kubernetes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-03-23/Kubernetesb系列-理解对象.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-03-23/Kubernetesb系列-理解对象.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="pod"><a href="#pod" class="headerlink" title="pod"></a>pod</h3><p>Pod是Kubernetes创建或部署的最小/最简单的基本单位，一个Pod代表集群上正在运行的一个进程。<br>一个Pod封装一个应用容器（也可以有多个容器），存储资源、一个独立的网络IP以及管理控制容器运行方式的策略选项。Pod代表部署的一个单位：Kubernetes中单个应用的实例，它可能由单个容器或多个容器共享组成的资源。<br>Controller可以创建和管理多个Pod，提供副本管理、滚动升级和集群级别的自愈能力。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018-03-23/Kubernetesb系列-理解对象.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-03-21/Kubernetesb系列-组件介绍.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-03-21/Kubernetesb系列-组件介绍.html" itemprop="url">Kubernetesb系列-组件介绍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-21T15:24:30+07:00">
                2018-03-21
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-03-23T13:09:35+07:00">
                2018-03-23
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/kubernetes/" itemprop="url" rel="index">
                    <span itemprop="name">kubernetes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-03-21/Kubernetesb系列-组件介绍.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-03-21/Kubernetesb系列-组件介绍.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>了解kubernetes各个组件，有助于深刻了解kubernetes是如何工作的</p>
<h3 id="Master组件"><a href="#Master组件" class="headerlink" title="Master组件"></a>Master组件</h3><p>Master组件提供集群的管理控制中心。通常运行在集群中的一个节点上，被称为主节点。kubernetes上所有指令都是发送给它，他来负责具体执行。master下面运行着下面这些组件。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018-03-21/Kubernetesb系列-组件介绍.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-03-21/Kubernetesb系列-集群环境部署.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-03-21/Kubernetesb系列-集群环境部署.html" itemprop="url">Kubernetesb系列-集群环境部署</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-21T09:59:57+07:00">
                2018-03-21
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-03-21T14:13:31+07:00">
                2018-03-21
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/kubernetes/" itemprop="url" rel="index">
                    <span itemprop="name">kubernetes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-03-21/Kubernetesb系列-集群环境部署.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-03-21/Kubernetesb系列-集群环境部署.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>所有节点的操作系统均为centos7.4 64位系统。三台机器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.40.131 master k8s-master</span><br><span class="line">192.168.40.130 worker k8s-node-1</span><br><span class="line">192.168.40.132 worker k8s-node-2</span><br></pre></td></tr></table></figure></p>
<p>参考：<a href="https://kubernetes.io/docs/setup/independent/install-kubeadm/" target="_blank" rel="noopener">https://kubernetes.io/docs/setup/independent/install-kubeadm/</a><br>注意：Kubernetes几乎所有的安装组件和Docker镜像都放在google自己的网站上。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018-03-21/Kubernetesb系列-集群环境部署.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-03-20/Kubernetesb系列-概述.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-03-20/Kubernetesb系列-概述.html" itemprop="url">Kubernetesb系列-概述</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-20T19:08:18+07:00">
                2018-03-20
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-03-21T13:27:58+07:00">
                2018-03-21
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/kubernetes/" itemprop="url" rel="index">
                    <span itemprop="name">kubernetes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-03-20/Kubernetesb系列-概述.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-03-20/Kubernetesb系列-概述.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>kubernetes是一个开源容器集群管理系统，可以实现容器集群的自动化部署、自动扩缩容、维护等功能。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018-03-20/Kubernetesb系列-概述.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-03-13/Dockerfile构建镜像.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-03-13/Dockerfile构建镜像.html" itemprop="url">Dockerfile构建镜像</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-13T07:04:38+07:00">
                2018-03-13
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-03-15T09:29:45+07:00">
                2018-03-15
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-03-13/Dockerfile构建镜像.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-03-13/Dockerfile构建镜像.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>Dockerfile是一个文本文件，其中包含若干条指令，指令描述了构建镜像的细节。</p>
<h3 id="构建镜像实例"><a href="#构建镜像实例" class="headerlink" title="构建镜像实例"></a>构建镜像实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> mkdir -p /home/dockerproject</span><br><span class="line"><span class="meta">$</span> touch /home/dockerproject/Dockerfile</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018-03-13/Dockerfile构建镜像.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-03-13/docker搭建私有仓库registry.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-03-13/docker搭建私有仓库registry.html" itemprop="url">docker私有仓库registry搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-13T07:04:38+07:00">
                2018-03-13
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-03-17T09:07:27+07:00">
                2018-03-17
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-03-13/docker搭建私有仓库registry.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-03-13/docker搭建私有仓库registry.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>参考 ：<a href="https://docs.docker.com/registry/deploying/" target="_blank" rel="noopener">https://docs.docker.com/registry/deploying/</a></p>
<h3 id="docker-registry镜像"><a href="#docker-registry镜像" class="headerlink" title="docker registry镜像"></a>docker registry镜像</h3><p>使用私有仓库，可以维护自己的镜像。docker 官方提供了 registry 的镜像，可以使用它来搭建私有仓库</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018-03-13/docker搭建私有仓库registry.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jinweida.github.io/2018-03-12/docker-swarm-集群部署.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="大汗">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金声玉振">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018-03-12/docker-swarm-集群部署.html" itemprop="url">docker-swarm-集群部署</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-12T07:04:38+07:00">
                2018-03-12
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-03-15T09:30:13+07:00">
                2018-03-15
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018-03-12/docker-swarm-集群部署.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018-03-12/docker-swarm-集群部署.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>docker-Swarm 在 docker1.12后已经集成在docker中，成为docker的一个子命令。</p>
<h3 id="swarm"><a href="#swarm" class="headerlink" title="swarm"></a>swarm</h3><p>目前docker指定的集群管理工具，有关集群的命令有：</p>
<ul>
<li>docker swarm：集群管理，子命令有 init, join,join-token, leave, update, unlock,ca,unlock-key</li>
<li>docker node：节点管理，子命令有 demote, inspect,ls, promote, rm, ps, update</li>
<li>docker service：服务管理，子命令有 create, inspect, ps, ls ,rm , scale, update</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018-03-12/docker-swarm-集群部署.html#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">大汗</p>
              <p class="site-description motion-element" itemprop="description">金声玉振</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">88</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/jinweida" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">大汗</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"your-duoshuo-shortname"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  


















  





  

  

  

  
  

  

  

  

</body>
</html>
